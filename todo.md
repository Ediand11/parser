–í–æ—Ç —á–∏—Å—Ç—ã–π –∫–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥ –±–µ–∑ –ª–∏—à–Ω–∏—Ö —Å–ª–æ–≤ ‚Äî –ø—Ä–æ—Å—Ç–æ –∏—Ç–æ–≥ —á–∞—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ —Ü–µ–ª–∏–∫–æ–º –æ—Ç–¥–∞—Ç—å Claude.

---

## üìå –ó–∞–¥–∞—á–∞

–ù—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –ø–∞—Ä—Å–µ—Ä –Ω–∞ **NestJS**, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –¥–≤—É–º —Å–∞–π—Ç–∞–º:

- [https://finuslugi.ru/navigator](https://finuslugi.ru/navigator)
- [https://t-j.ru/](https://t-j.ru/)

–∏ —Å–æ–±–∏—Ä–∞–µ—Ç CSV —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:

| –û—Å–Ω–æ–≤–Ω–∞—è —Å—Å—ã–ª–∫–∞ | –°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–∞–∑–¥–µ–ª | –°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—å—é | –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ | –í—Å—è —Å—Ç–∞—Ç—å—è |

---

## üìå robots.txt ‚Äî —á—Ç–æ –º–æ–∂–Ω–æ –∏ —á—Ç–æ –Ω–µ–ª—å–∑—è

### **finuslugi.ru**

–†–∞–∑—Ä–µ—à–µ–Ω–æ:

- `/navigator` –∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã `/navigator/...`
- –æ–±—ã—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –±–µ–∑ —Ç–µ–≥–æ–≤-—Ñ–∏–ª—å—Ç—Ä–æ–≤

–ó–∞–ø—Ä–µ—â–µ–Ω–æ:

- `/banki/*`
- `/ipoteka/*`
- `/arhiv_*`
- –ª—é–±—ã–µ —Å—Å—ã–ª–∫–∏ —Å `yclid=` –∏–ª–∏ `gclid=`
- –≤—Å—ë, —á—Ç–æ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∏–ª—å—Ç—Ä—ã/–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ `Disallow` –±–ª–æ–∫–∞

‚û°Ô∏è –í—ã–≤–æ–¥: –ø–∞—Ä—Å–∏–º **—Ç–æ–ª—å–∫–æ `/navigator` –∏ –¥–æ—á–µ—Ä–Ω–∏–µ —Å—Ç–∞—Ç—å–∏**, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º `/banki`, `/ipoteka`, `/arhiv` –∏ URL —Å —Ä–µ–∫–ª–∞–º–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

### **t-j.ru**

–†–∞–∑—Ä–µ—à–µ–Ω–æ:

- –≤—Å–µ –æ–±—ã—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –ø—É–±–ª–∏—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏

–ó–∞–ø—Ä–µ—â–µ–Ω–æ:

- `/api/*`
- `/login/`
- `/exam/`
- `/recommendations/`
- `/look/`

‚û°Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å sitemap: [https://t-j.ru/sitemap.xml](https://t-j.ru/sitemap.xml)
–ø–æ –Ω–µ–º—É –º–æ–∂–Ω–æ —Å–æ–±–∏—Ä–∞—Ç—å —Å—Ç–∞—Ç—å–∏ –Ω–∞–ø—Ä—è–º—É—é –±–µ–∑ –æ–±—Ö–æ–¥–∞ —Å–ø–∏—Å–∫–∞.

---

## üìå –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±–æ—Ç—É

- User-Agent –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–Ω–µ** Yandex/Twitterbot
- Rate limit: **1 –∑–∞–ø—Ä–æ—Å/—Å–µ–∫**
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å: **p-limit(2‚Äì3)** –≤ –º–∞–∫—Å–∏–º—É–º

–ù–∞–ø—Ä–∏–º–µ—Ä:

```ts
User-Agent: Mozilla/5.0 (compatible; LevScraper/1.0; +https://example.com/bot-info)
```

---

## üìå –°—Ç—Ä—É–∫—Ç—É—Ä–∞ CSV

| –ö–æ–ª–æ–Ω–∫–∞    | –ó–Ω–∞—á–µ–Ω–∏–µ                                                                                                |
| ---------- | ------------------------------------------------------------------------------------------------------- |
| mainUrl    | [https://finuslugi.ru/navigator](https://finuslugi.ru/navigator) –∏–ª–∏ [https://t-j.ru/](https://t-j.ru/) |
| sectionUrl | URL —Ä–∞–∑–¥–µ–ª–∞                                                                                             |
| articleUrl | URL —Å—Ç–∞—Ç—å–∏                                                                                              |
| title      | –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏                                                                                        |
| content    | –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç (–∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)                                                                  |

---

## üìå NestJS –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
/src
  /common
    http-client.service.ts (axios wrapper + headers + retry)
    extract-text.util.ts
  /parsers
    finuslugi-parser.service.ts
    tj-parser.service.ts
  /export
    csv-export.service.ts
  scraper.service.ts
```

---

## üìå –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ö–æ–¥–∞

### Finuslugi:

1. –ë–µ—Ä—ë–º `https://finuslugi.ru/navigator`
2. –ù–∞—Ö–æ–¥–∏–º —Å—Å—ã–ª–∫–∏ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ `/navigator/...`
3. –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ robots.txt:
   - –∏—Å–∫–ª—é—á–∞–µ–º `/banki`, `/ipoteka`, `/arhiv_`, `yclid`, `gclid`

4. –ü—Ä–æ—Ö–æ–¥–∏–º —Å—Ç–∞—Ç—å–∏
5. –ò–∑ –∫–∞–∂–¥–æ–π –≤—ã—Ç–∞—Å–∫–∏–≤–∞–µ–º:
   - `<h1>`
   - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### T-J:

2 –≤–∞—Ä–∏–∞–Ω—Ç–∞:

- –ª–∏–±–æ –æ–±—Ö–æ–¥ —Ä–∞–∑–¥–µ–ª–æ–≤ (`/investitsii`, `/novosti`, `/dnevniki-trat`‚Ä¶)
- –ª–∏–±–æ **–ª—É—á—à–µ** –≤–∑—è—Ç—å `https://t-j.ru/sitemap.xml` –∏ –æ—Ç—Ç—É–¥–∞ –ø—Ä—è–º –≤—Å–µ `<loc>` —Å–æ —Å—Ç–∞—Ç—å—è–º–∏

–î–∞–ª–µ–µ –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç–∞—Ç—å–µ:

- –±–µ—Ä—ë–º `<h1>`
- –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–µ–∫—Å—Ç–∞ (—Å–µ–ª–µ–∫—Ç–æ—Ä –ø–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ DevTools)

---

## üìå –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è URL

### Finuslugi

```ts
if url.includes('/banki/') || url.includes('/ipoteka/') || url.includes('/arhiv_') return false;
if url.includes('yclid=') || url.includes('gclid=') return false;
return url.includes('/navigator/');
```

### T-J

```ts
if url.includes('/api/') || url.includes('/login/') || url.includes('/exam/') ||
   url.includes('/recommendations/') || url.includes('/look/') return false;
return true;
```

---

## üìå CSV-—ç–∫—Å–ø–æ—Ä—Ç

```ts
createObjectCsvWriter({
  path: 'articles.csv',
  header: [
    { id: 'mainUrl', title: '–û—Å–Ω–æ–≤–Ω–∞—è —Å—Å—ã–ª–∫–∞' },
    { id: 'sectionUrl', title: '–°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–∞–∑–¥–µ–ª' },
    { id: 'articleUrl', title: '–°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—å—é' },
    { id: 'title', title: '–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏' },
    { id: 'content', title: '–í—Å—è —Å—Ç–∞—Ç—å—è' },
  ],
});
```

---

## üìå –ò—Ç–æ–≥

- –ü–∞—Ä—Å–∏–º **—Ç–æ–ª—å–∫–æ –æ—Ç–∫—Ä—ã—Ç—ã–µ –¥–ª—è –±–æ—Ç–æ–≤ –∑–æ–Ω—ã**.
- Finuslugi: —Å—Ç—Ä–æ–≥–æ –≤–Ω—É—Ç—Ä–∏ `/navigator`, –∏—Å–∫–ª—é—á–∞—è `/banki`, `/ipoteka`, `/arhiv`, `gclid/yclid`.
- T-J: —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –≤—Å—ë, –∫—Ä–æ–º–µ `/api`, `/login`, `/exam`, `/recommendations`, `/look`.
- –ö–æ–Ω—Ç–µ–Ω—Ç –¥–æ—Å—Ç–∞–µ–º –∏–∑ `<h1>` –∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–ª–æ–∫–∞ —Å—Ç–∞—Ç–µ–π.
- –°–æ–±–∏—Ä–∞–µ–º –≤ CSV —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å —ç–∫—Å–ø–æ—Ä—Ç–∞.
- Rate limit —Å—Ç—Ä–æ–≥–æ —Å–æ–±–ª—é–¥–∞–µ–º.

---

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –º–æ–≥—É –¥–æ–ø–æ–ª–Ω–∏—Ç—å:

- —Ç–æ—á–Ω—ã–µ CSS-—Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –æ–±–æ–∏—Ö —Å–∞–π—Ç–æ–≤
- –≥–æ—Ç–æ–≤—ã–π –º–æ–¥—É–ª—å —Å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–º `ScraperService`
- –≤–∞—Ä–∏–∞–Ω—Ç –±–µ–∑ Cheerio, –Ω–æ —Å JS DOM + Puppeteer (–µ—Å–ª–∏ –Ω–∞—á–Ω—É—Ç –æ—Ç–¥–∞–≤–∞—Ç—å 403/anti-scrape)

–ì–æ—Ç–æ–≤ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å.
